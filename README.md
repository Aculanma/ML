# ML

Домашнее задание состоит из трех частей:
1. Анализ данных;
2. Обучение модели для прогнозирования цен машин;
3. Реализация веб-сервиса для предсказания цен на машины.  

### 1. Анализ данных
В этой части я знакомился с данными, выполнил проверку на пропуски, дубли. Обработал пропуски - заполнил пропуски медианными значениями, предварительно откинув единицы измерений признаков. Проверил размах значений - были аномалии, например, расход топлива равный 0, такие случаи я также заполнил медианными значениями по колонке; Выполнил приведение к нужным типам наших признаков; Построил с помощью ydata_profiling инфографику по нашим данным; Посмотрел основные описательные статистики; Построил распределение признаков тренировочных и тестовых данных, и сравнил их меж собой - распределения оказались довольно похожими; Выдвинул предположения о том, что есть связь признаков с целевой переменной, построив матрицу корреляции Пирсона.

### 2. Обучение модели для прогнозирования цен машин  
- Всё началось с обучения классической линейной регрессии с дефолтными параметрами. Для данной модели и всех последующих я считал R2 и MSE для тренировочных и тестовых данных. Получил  различный почти в 2 раза MSE на тестовых данных данных, который полагаю говорит о том, что у нас произошло переобучение, т.е. у модели, скажем, средняя обобщая способность, при этом у нас довольно схожие получились R2, и их значение почти 0,6, а R2 у нас показывает, насколько модель лучше "среднего". Оценка в 0.6 тоже говорит о неком среднем уровне качества модели;  
- Далее я стандартизировал признаки, снова обучил модель, посчитал метрики - результатов это не дало;
- Затем обучил Lasso регрессию на тренировочном наборе данных с нормализованными признаками. Посчитал метрики. L-1 регуляризация при параметрах по умолчанию (alpha=1) не обнулила никакие веса, возможно это произошло потому, что наши признаки не так слабо связаны между собой и ко всему этому, мы взяли маленький alpha, которого, кажется, оказалось недостаточным, чтобы занулить какие-нибудь веса;
- Далее перебором по сетке (c 10-ю фолдами) попробовал подобрать оптимальные параметры для Lasso-регрессии. Грид-сёрчем обучил 60 моделей и лучшим коэффициентом регуляризации из перебранных моделей стала alpha = 1000;  
- Затем схожую работу выполнил для ElasticNet регрессии, также пробовал подбирать параметры alpha и l1_ratio по кросс-валидации. С помощью грид-сёрча обучил 160 моделей, и лучшими гиперпараметрами оказались alpha = 1000 и l1_ratio = 1, но улучшеyий качества всё не наблюдалось;
- И всё-таки удалось улучшить качество модели, добавив категориальные переменные, с помощью гребневной (ridge) регрессии - R2 вырос до 0.65 с 0.59 для всех предыдущих реализаций. 
- И финальным в этой части была реализация своей метрики, которая бы считала долю прогнозов, отличающихся от реальных цен на авто не более чем на 10% (в одну или другую сторону) - лучше всего с этим справилась самая лучшая модель (ridge) - тут без неожиданностей. Попробую объяснить почему это произошло. Мы добавили в модель категориальные признаки, которые несут в себе полезную информацию и это помогло модели лучше понять и объяснить данные, как результат - улучшение метрики качества.  

### 3. Реализация веб-сервиса для предсказания цен на машины
В этой части было реализовано два сценария:
1. на вход в формате json подаются признаки одного объекта, на выходе сервис выдает предсказанную стоимость машины;
2. на вход подается csv-файл с признаками тестовых объектов, на выходе получаем файл с +1 столбцом - предсказаниями на этих объектах.
Эта часть, пожалуй, как и обучение моделей, была очень сложной для меня, как для новичка, но жизнеспособную версию всё же реализовать удалось. Работу веб-сервиса можно посмотреть на скриншотах в репозитории. 
